<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Battery Recycle Bin â€“ Demo</title>
  <style>
    :root{
      --bg: #f6fbff;
      --surface: #ffffff;
      --text: #0d1b2a;
      --muted: #54728c;
      --green: #27ae60;
      --blue: #2d9cdb;
      --red: #e74c3c;
      --glow: 0 10px 30px rgba(45,156,219,0.25);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--text);
      background: linear-gradient(180deg, #eff9ff 0%, #f7fffb 100%);
    }
    .app{
      min-height:100%;
      display:grid;
      grid-template-rows:auto 1fr auto;
    }
    /* Header */
    header{
      display:flex;align-items:center;gap:12px;
      padding:16px 20px; 
    }
    .logo{
      width:40px;height:40px;border-radius:12px;
      background: radial-gradient(circle at 30% 30%, #9be7ff, #7fd3ff 40%, #7fffd6 100%);
      position:relative; box-shadow:var(--glow);
    }
    /* battery-bin glyph */
    .logo svg{position:absolute; inset:0; width:100%; height:100%;}
    .brand{font-weight:700;letter-spacing:.2px}
    .counter{margin-left:auto; font-weight:600; background:#fff; padding:8px 12px; border-radius:999px; box-shadow:var(--glow); color:#1673a6}

    /* Canvas card */
    .card{
      width:min(900px, 92vw);
      margin:24px auto 48px;
      background:var(--surface);
      border-radius:var(--radius);
      box-shadow:0 10px 30px rgba(13,27,42,0.08);
      padding:28px; position:relative; overflow:hidden;
    }
    /* Accent aura */
    .card::after{
      content:""; position:absolute; inset:-40% -20% auto auto; height:60%; width:60%;
      background: radial-gradient( circle at 70% 30%, rgba(45,156,219,.12), transparent 60% );
      pointer-events:none;
    }

    /* Screens */
    .screen{display:block}
    .screen[hidden]{display:none !important}
    .screen.active{animation:fadeIn .35s ease}
    @keyframes fadeIn{from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:translateY(0)} to{opacity:1; transform:translateY(0)}}

    .center{display:grid; place-items:center; text-align:center; gap:16px; padding:20px}

    h1{margin:8px 0 0; font-size:clamp(24px, 3.6vw, 36px)}
    p.lead{color:var(--muted); margin:0 0 8px; font-size:clamp(14px, 2.2vw, 18px)}

    .big-btn{
      font-size:clamp(16px, 2.4vw, 22px); font-weight:700;
      padding:18px 28px; border-radius:24px; border:none; cursor:pointer;
      color:#fff;
      background: linear-gradient(135deg, var(--blue), #00c2a8);
      box-shadow: 0 10px 28px rgba(45,156,219,0.35);
      transition: transform .08s ease, filter .2s ease;
    }
    .big-btn:hover{ filter:brightness(1.03)}
    .big-btn:active{ transform:scale(.98)}

    .row{display:flex; flex-wrap:wrap; align-items:center; justify-content:center; gap:18px}
    .ghost-btn{
      background:#e9fbf4; color:#0f7f4c; border:none; padding:12px 18px; border-radius:16px; font-weight:600; cursor:pointer
    }
    .outline-btn{
      background:transparent; border:2px solid #bfe9ff; color:#1673a6; padding:12px 18px; border-radius:16px; font-weight:600; cursor:pointer
    }

    /* Modal */
    .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.35); padding:16px }
    .modal.open{ display:flex; animation:fadeIn .2s ease }
    .modal .sheet{ background:#fff; width:min(560px, 92vw); border-radius:20px; padding:24px; box-shadow:0 10px 30px rgba(0,0,0,.18) }
    .modal .sheet h3{ margin:0 0 6px }
    .modal .sheet p{ margin:0 0 14px; color:var(--muted) }

    /* Simple slot animation */
    .bin-demo{ width:200px; height:140px; position:relative; margin:10px auto 2px }
    .bin-body{ position:absolute; inset:20px 40px 14px 40px; border-radius:14px; background:linear-gradient(180deg,#e6f7ff,#d8fff1) ; box-shadow:inset 0 0 0 2px #bfe9ff }
    .slot{ position:absolute; left:50%; transform:translateX(-50%); top:20px; width:120px; height:12px; background:#0ea5a0; border-radius:6px; box-shadow:0 2px 0 #088c86 }
    .lid{ position:absolute; left:50%; transform:translateX(-50%); top:16px; width:130px; height:10px; background:#2d9cdb; border-radius:6px; transform-origin:left center; animation:lidClose .8s ease forwards }
    .lid.open{ animation:lidOpen .8s ease forwards }
    @keyframes lidOpen{ 0%{ transform:translateX(-50%) rotate(0) } 60%{ transform:translateX(-50%) rotate(-35deg) } 100%{ transform:translateX(-50%) rotate(-28deg) } }
    @keyframes lidClose{ 0%{ transform:translateX(-50%) rotate(-28deg) } 100%{ transform:translateX(-50%) rotate(0) } }

    /* Detecting */
    .scan{
      width: 70%; max-width:520px; height:14px; border-radius:999px; background:#e8f5ff; overflow:hidden; box-shadow:inset 0 0 0 2px #cfeaff
    }
    .scan .bar{ height:100%; width:35%; background:linear-gradient(90deg, #6fc8ff, #00c2a8); border-radius:999px; animation:slide 1.1s ease-in-out infinite }
    @keyframes slide{ 0%{ transform:translateX(-20%) } 50%{ transform:translateX(120%) } 100%{ transform:translateX(-20%) } }

    .result-icon{ width:80px; height:80px; border-radius:50%; display:grid; place-items:center; margin:10px auto 6px }
    .ok{ background:#e7fbf0; box-shadow:0 0 0 6px #e7fbf0 inset; color:var(--green) }
    .no{ background:#ffeaea; box-shadow:0 0 0 6px #ffeaea inset; color:var(--red) }

    /* Footer */
    footer{ padding:18px; text-align:center; color:#6c8599; font-size:14px }

    /* Demo panel */
    .panel{
      position:fixed; right:18px; bottom:18px; z-index:9; background:#ffffffd9; backdrop-filter:saturate(140%) blur(4px);
      border:1px solid #d6eefc; border-radius:16px; box-shadow:0 12px 26px rgba(13,27,42,.12);
      padding:12px 12px 8px; width:min(320px, 90vw);
    }
    .panel h4{ margin:0 0 8px; font-size:14px; color:#1673a6 }
    .panel label{ display:block; margin:4px 0; font-size:14px }
    .panel .row{ justify-content:space-between }
    .tiny{ font-size:12px; color:#6c8599 }
    .chip{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:#eefaff; color:#1673a6; font-weight:600 }
  .scanframe{ width:min(520px, 86vw); height:240px; margin:0 auto 8px; background:#0b0b0b; border-radius:16px; position:relative; box-shadow:inset 0 0 0 4px #0b0b0b, 0 8px 20px rgba(0,0,0,.2) }
    .scanframe::before{ content:""; position:absolute; inset:12px; background:#e9eef2; border-radius:10px }
    .scanner{ position:absolute; left:16px; right:16px; height:3px; top:24px; background:#ff3b30; box-shadow:0 0 10px rgba(255,59,48,.7); border-radius:2px; animation:scanY 1.8s ease-in-out infinite }
    @keyframes scanY{ 0%{ top:24px } 50%{ top:calc(100% - 24px) } 100%{ top:24px } }

    /* IRIS (multi-blade) */
    .irisWrap{ width:260px; height:260px; margin:10px auto; border-radius:50%; background:radial-gradient(circle at 50% 40%, #e6f7ff, #d8fff1); box-shadow:inset 0 0 0 2px #bfe9ff; display:grid; place-items:center; overflow:hidden }
    svg.iris{ width:220px; height:220px; }
    .blade{ transform-origin:110px 110px; transition:transform 1.8s ease-in-out; fill:#2d3e50 }
    .iris.open .blade{ transform:scale(0.02); }

    .outline-btn.danger{ border:2px solid #ffc8c2; color:#d12a1b; background:#fff5f4; font-weight:700 }
    .outline-btn.danger:hover{ filter:brightness(1.03) }
    .blade{ transform-origin:110px 110px; transition:transform .6s ease; fill:#2d3e50 }
    .iris.open .blade.b1{ transform:rotate(-30deg) translate(-12px,-12px) }
    .iris.open .blade.b2{ transform:rotate(30deg) translate(12px,-12px) }
    .iris.open .blade.b3{ transform:rotate(90deg) translate(12px,12px) }
    .iris.open .blade.b4{ transform:rotate(150deg) translate(-12px,12px) }
    .iris.open .blade.b5{ transform:rotate(210deg) translate(-22px,0) }
    .iris.open .blade.b6{ transform:rotate(270deg) translate(22px,0) }
    .aperture::after{ content:""; position:absolute; inset:0; background:radial-gradient(circle at 50% 50%, #2d9cdb 0 60%, transparent 61%); filter:drop-shadow(0 6px 10px rgba(45,156,219,.35)); clip-path:circle(50% at 50% 50%); transition:clip-path .8s ease; }
    .aperture.open::after{ clip-path:circle(0% at 50% 50%); }
  .big-btn.danger{ color:#fff; background:linear-gradient(135deg,#ff6b6b,#ff3b30); box-shadow:0 10px 28px rgba(255,59,48,0.35) }
    .big-btn.danger:hover{ filter:brightness(1.03) }
  </style>
</head>
<body>
  <div class="app" role="application">
    <header>
      <div class="logo" aria-hidden="true">
        <svg viewBox="0 0 100 100" fill="none" aria-hidden="true">
          <rect x="28" y="25" width="44" height="50" rx="10" fill="#fff" stroke="#0ea5a0" stroke-width="4" />
          <rect x="22" y="22" width="56" height="10" rx="5" fill="#2d9cdb" />
          <rect x="36" y="40" width="28" height="18" rx="4" fill="#2d9cdb" opacity="0.9" />
          <rect x="42" y="46" width="16" height="6" rx="3" fill="#fff" />
        </svg>
      </div>
      <div class="brand">Smart Battery Recycle Bin</div>
      <div class="counter" aria-live="polite">Batteries today: <span id="count">0</span></div>
    </header>

    <main class="card" aria-live="polite">
      <!-- WELCOME -->
      <section id="welcome" class="screen active center" aria-label="Welcome">
        <h1>Welcome!</h1>
        <p class="lead" 
        style="max-width:60ch;
          margin:10px auto 0;
          font-size:18px;
          line-height:1.6;
          color:#2d4a3f;
          text-align:center;">Join our mission to make battery recycling safer and smarter!</p>
        <button class="big-btn" id="startBtn">Start Recycling</button>
        
        <p class="lead" 
          style="max-width:60ch;
          margin:10px auto 0;
          font-size:16px;
          line-height:1.6;
          
          text-align:center;">
          Every small action counts â€” by recycling your batteries properly. <br>
          You help prevent fires, protect our community,
          and keep harmful metals out of the environment.
          </p>
          <p style="text-align:center; color:#0f7f4c; font-size:19px; font-weight:bold;">
            Together, we can power a cleaner future.
          </p>
      </section>

      <!-- DETECTING -->
      <section id="detect" class="screen center" hidden aria-label="Detecting">
        <div class="chip" aria-hidden="true">Scanning</div>
        <h1>Detecting battery typeâ€¦</h1>
        <div class="scan" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuetext="Scanning">
          <div class="bar"></div>
        </div>
        <p class="lead">Please wait a moment while we identify your battery.</p>
      </section>

      <!-- CHOOSE DETECTED TYPE (manual) -->
      <section id="choose" class="screen center" hidden aria-label="Choose Result">
        <h1>Select detected type</h1>
        <p class="lead">For demo purposes, pick the outcome below.</p>
        <div class="row" style="gap:12px; max-width:780px; margin:auto; flex-direction:column;">
          <button class="big-btn" id="chooseLi">Lithium-based Batteries</button>
          <button class="big-btn" id="chooseAlk" style="background:linear-gradient(135deg,#2d9cdb,#00c2a8)">Alkaline &amp; Zincâ€‘Carbon Batteries</button>
          <button class="big-btn" id="chooseLead" style="background:linear-gradient(135deg,#2d9cdb,#00c2a8)">Leadâ€‘containing Batteries</button>
          <button class="big-btn danger" id="chooseReject">Not accepted here</button>
          <button class="big-btn danger" id="chooseFail">Scan unsuccessful â€“ try again</button>
        </div>
      </section>

      <!-- RESULT: ACCEPTED -->
      <section id="accepted" class="screen center" hidden aria-label="Accepted">
        <div class="result-icon ok" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="40" height="40"><path fill="currentColor" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>
        </div>
        <h1>Battery accepted!</h1>
        <p class="lead">Type <span id="typeAccepted">A</span> recognized. Thank you for recycling!</p>
        <div class="row">
          <button class="ghost-btn" id="againOk">Recycle another battery</button>
          <button class="outline-btn" id="finishOk">Finish</button>
        </div>
      </section>

      <!-- RESULT: REJECTED -->
      <section id="rejected" class="screen center" hidden aria-label="Rejected">
        <div class="result-icon no" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="40" height="40"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm4.3 13.9-1.4 1.4L12 13.4l-2.9 2.9-1.4-1.4 2.9-2.9-2.9-2.9 1.4-1.4 2.9 2.9 2.9-2.9 1.4 1.4-2.9 2.9 2.9 2.9z"/></svg>
        </div>
        <h1>Not accepted here</h1>
        <p class="lead" id="rejectedMsg">Please refer to a staff member for help to redirect to a safe disposal site that accept this type of battery.</p>
        <div class="row">
          <button class="ghost-btn" id="againNo">Try another battery</button>
          <button class="outline-btn" id="finishNo">Finish</button>
        </div>
      </section>

      
      <!-- COMPLETION -->
      <section id="done" class="screen center" hidden aria-label="Completed">
        <h1 style="font-size:2.2rem; font-weight:800; color:#023047; margin-bottom:14px;">
          Great job!
        </h1>
      
        <p class="lead" style="max-width:60ch; margin:0 auto 10px; line-height:1.6; font-size:1.05rem;">
          Thank you for your contribution to safer e-waste handling. <br>
          By recycling batteries properly, we reduce fire risks <br>
          and prevent toxic metals from entering our environment.
        </p>
      
        <p class="lead" style="max-width:60ch; margin:10px auto 20px; line-height:1.6; font-size:1.05rem;">
          So far today, this collection point has safely processed
          <strong style="color:#0f7f4c;"><span id="countFinal">0</span></strong> batteries. <br>
          <strong style="color:#0f367f;">Every single one helps.</strong>
        </p>
      
        <div class="row" style="margin-top:22px;">
          <button class="ghost-btn" id="backHome" style="background:#e9fbf4; color:#0f7f4c; font-weight:600;">
            Back to Start
          </button>
        </div>
      </section>


      <!-- RESCAN HELP -->
      <section id="rescan" class="screen center" hidden aria-label="Rescan Help">
        <h1>Scan unsuccessful</h1>
        <p class="lead">Please adjust the angle or lighting, and ensure the label is in the frame.</p>
        <div class="row">
          <button class="ghost-btn" id="retryScan">Try Again</button>
          <button class="outline-btn" id="backWelcome">Back</button>
        </div>
      </section>
    </main>

    <footer>
      Designed for the City of Melbourne e-waste management initiative. <br> 
      Developed by ENGR90051 Group 3-J.
    </footer>
  </div>

  <!-- INSERT INSTRUCTION MODAL -->
  <!-- CAMERA / SCAN INSTRUCTION MODAL -->
  <div class="modal" id="cameraModal" role="dialog" aria-modal="true" aria-label="Camera Scan">
    <div class="sheet">
      <div class="scanframe" aria-hidden="true">
        <div class="scanner"></div>
      </div>
      <h3>Point your camera at the battery</h3>
      <p>On a phone, the camera opens to scan the label. This demo simulates the scan.</p>
      <div class="row">
        <button class="big-btn" id="startScan">Start Scan</button>
      </div>
    </div>
  </div>


  <script>
    const screens = {
      welcome: document.getElementById('welcome'),
      detect: document.getElementById('detect'),
      choose: document.getElementById('choose'),
      accepted: document.getElementById('accepted'),
      rejected: document.getElementById('rejected'),
      rescan: document.getElementById('rescan'),
      done: document.getElementById('done')
    };

    const countEl = document.getElementById('count');
    const countFinal = document.getElementById('countFinal');
    const typeAccepted = document.getElementById('typeAccepted');
    const rejectedMsg = document.getElementById('rejectedMsg');

    const cameraModal = document.getElementById('cameraModal');

    // Iris modal
    const irisModalHtml = `
      <div class="modal" id="irisModal" role="dialog" aria-modal="true" aria-label="Deposit Battery">
        <div class="sheet" style="text-align:center">
          <h3>Deposit battery</h3>
          <div class="irisWrap">
            <svg class="iris" id="irisSVG" viewBox="0 0 220 220" aria-hidden="true">
              <!-- six equal wedges (pie slices) -->
              <path class="blade" d="M110,110 L210,110 A100,100 0 0 1 160,196.6 Z"/>
              <path class="blade" d="M110,110 L160,196.6 A100,100 0 0 1 60,196.6 Z"/>
              <path class="blade" d="M110,110 L60,196.6 A100,100 0 0 1 10,110 Z"/>
              <path class="blade" d="M110,110 L10,110 A100,100 0 0 1 60,23.4 Z"/>
              <path class="blade" d="M110,110 L60,23.4 A100,100 0 0 1 160,23.4 Z"/>
              <path class="blade" d="M110,110 L160,23.4 A100,100 0 0 1 210,110 Z"/>
            </svg>
          </div>
          <div class="row" style="justify-content:center">
            <button class="big-btn" id="irisDone">Done</button>
          </div>
        </div>
      </div>`;
    document.body.insertAdjacentHTML('beforeend', irisModalHtml);
    const irisModal = document.getElementById('irisModal');
    const irisSVG = document.getElementById('irisSVG');

    const startBtn = document.getElementById('startBtn');
    const startScan = document.getElementById('startScan');

    const againOk = document.getElementById('againOk');
    const finishOk = document.getElementById('finishOk');
    const againNo = document.getElementById('againNo');
    const finishNo = document.getElementById('finishNo');
    const backHome = document.getElementById('backHome');

    const retryScan = document.getElementById('retryScan');
    const backWelcome = document.getElementById('backWelcome');

    const chooseLi = document.getElementById('chooseLi');
    const chooseAlk = document.getElementById('chooseAlk');
    const chooseLead = document.getElementById('chooseLead');
    const chooseReject = document.getElementById('chooseReject');
    const chooseFail = document.getElementById('chooseFail');

    // Legacy demo panel (keep to not break)
    const outcomeSel = document.getElementById('outcome');
    const skipToDetect = document.getElementById('skipToDetect');
    const skipToResult = document.getElementById('skipToResult');

    function show(id){
      Object.values(screens).forEach(s=>{ s.classList.remove('active'); s.hidden = true; });
      screens[id].hidden = false;
      screens[id].classList.add('active');
    }

    // Daily counter with localStorage
    function keyForToday(){
      const d = new Date();
      return `batteryCount-${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;
    }
    function getCount(){ return parseInt(localStorage.getItem(keyForToday())||'0',10); }
    function setCount(v){ localStorage.setItem(keyForToday(), String(v)); syncCounts(); }
    function incCount(){ setCount(getCount()+1); }
    function syncCounts(){ countEl.textContent = getCount(); countFinal.textContent = getCount(); }
    syncCounts();

    function openCamera(){ cameraModal.classList.add('open'); }
    function closeCamera(){ cameraModal.classList.remove('open'); }

    // Fake detection flow
    function startDetection(){
      show('detect');
      const ms = 1500 + Math.random()*1200;
      setTimeout(()=>{ show('choose'); }, ms);
    }

    let selectedType = null; // label for accepted screen

    function openIris(typeLabel){
      selectedType = typeLabel;
      irisModal.classList.add('open');
      requestAnimationFrame(()=>{ irisSVG.classList.add('open'); });
    }

    function closeIris(){
      irisSVG.classList.remove('open');
      setTimeout(()=>{ irisModal.classList.remove('open'); }, 450);
    }

    // Events
    startBtn.addEventListener('click', openCamera);
    startScan?.addEventListener('click', ()=>{ closeCamera(); startDetection(); });

    // Choose outcomes
    chooseLi?.addEventListener('click', ()=> openIris('Lithium-based Batteries'));
    chooseAlk?.addEventListener('click', ()=> openIris('Alkaline & Zinc-Carbon Batteries'));
    chooseLead?.addEventListener('click', ()=> openIris('Lead-containing Batteries'));

    chooseReject?.addEventListener('click', ()=>{
      rejectedMsg.textContent = 'Please place the battery in the side bin. A staff member will handle it separately. Thank you for keeping everyone safe.';
      show('rejected');
      incCount();
    });

    chooseFail?.addEventListener('click', ()=>{ show('rescan'); });

    document.body.addEventListener('click', (e)=>{
      if(e.target && e.target.id === 'irisDone'){
        closeIris();
        typeAccepted.textContent = selectedType || 'Battery';
        show('accepted');
        incCount();
      }
    });

    againOk.addEventListener('click', ()=> show('welcome'));
    finishOk.addEventListener('click', ()=> { show('done'); syncCounts(); });
    againNo.addEventListener('click', ()=> show('welcome'));
    finishNo.addEventListener('click', ()=> { show('done'); syncCounts(); });
    backHome.addEventListener('click', ()=> show('welcome'));

    retryScan?.addEventListener('click', ()=>{ openCamera(); });
    backWelcome?.addEventListener('click', ()=> show('welcome'));

    // Demo panel shortcuts
    skipToDetect?.addEventListener('click', ()=> startDetection());
    skipToResult?.addEventListener('click', ()=>{ show('choose'); });

    // Keyboard accessibility
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape' && cameraModal.classList.contains('open')) closeCamera();
      if(e.key==='Escape' && irisModal.classList.contains('open')) closeIris();
    });
  </script>
  <noscript>
    <div style="margin:16px; padding:12px; background:#fff3cd; border:1px solid #ffe69c; border-radius:12px; color:#6c4a00;">
      This demo requires JavaScript to switch screens. Please enable JavaScript.
    </div>
  </noscript>
</body>
</html>
